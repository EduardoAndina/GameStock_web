<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>GameStock | Vendas</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <link rel="stylesheet" href="/css/sistema.css">
</head>

<body>

<div class="sidebar">
    <h2>GAMESTOCK</h2>

    <a th:href="@{/jogos}">
        <i class="bi bi-controller"></i>
        Jogos
    </a>

    <a th:href="@{/funcionarios}">
        <i class="bi bi-people"></i>
        Funcionários
    </a>

    <a th:href="@{/vendas}" class="active">
        <i class="bi bi-cash-coin"></i>
        Vendas
    </a>
    
    <a th:href="@{/logout}">
        <i class="bi bi-box-arrow-right"></i> Sair
    </a>
</div>

<div class="main">

    <div class="hero">
        <div th:if="${erro}" class="alert alert-danger text-center">
    <span th:text="${erro}"></span>
</div>

<div th:if="${sucesso}" class="alert alert-success text-center">
    <span th:text="${sucesso}"></span>
</div>

        <h1>Vendas</h1>
        <p>Gerencie e acompanhe todas as vendas realizadas</p>
    </div>

    <div class="card">

        <div class="table-header">
            <h5>Lista de Vendas</h5>

            <div class="search-box-wrapper">
                <i class="bi bi-search"></i>
                <input type="text"
                       class="form-control search-box"
                       placeholder="Pesquisar venda"
                       id="buscaVendas">
            </div>
        </div>

        <div class="table-wrapper">
            <table class="table table-hover align-middle" id="tabelaVendas">
                <thead>
                <tr>
                    <th>ID da Venda</th>
                    <th>ID do Jogo</th>
                    <th>Nome do Jogo</th>
                    <th>Categoria</th>
                    <th>Quantidade</th>
                    <th>Valor Pago</th>
                    <th>Cliente</th>
                    <th>Telefone</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="v : ${vendas}" th:data-id="${v.id}">
                    <td th:text="${v.id}"></td>
                    <td th:text="${v.jogo.id}"></td>
                    <td th:text="${v.jogo.nome}"></td>
                    <td th:text="${v.jogo.categoria}"></td>
                    <td th:text="${v.quantidadeVendida}"></td>
                    <td th:text="${v.valorPago}"></td>
                    <td th:text="${v.nomeCliente}"></td>
                    <td th:text="${v.telefoneCliente}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="action-bar">
            <button class="btn btn-success" onclick="abrirModalCadastrar()">
                <i class="bi bi-plus-circle"></i> Cadastrar Venda
            </button>

            <button class="btn btn-primary" onclick="abrirModalEditar()">
                <i class="bi bi-pencil-square"></i> Editar Venda
            </button>

            <button class="btn btn-danger" onclick="abrirModalExcluir()">
                <i class="bi bi-trash"></i> Excluir Venda
            </button>
        </div>

    </div>
</div>

<div id="modalCadastrar" class="modal-overlay">
    <div class="modal-box modal-grande">

        <div class="modal-header">
            <h2>Registrar Venda</h2>
            <button class="close-btn" onclick="fecharTodos()">&times;</button>
        </div>

        <div class="modal-body">

            <div class="search-box-wrapper mb-3">
                <i class="bi bi-search"></i>
                <input type="text"
                       class="form-control search-box"
                       placeholder="Pesquisar jogo"
                       id="buscaJogosVenda">
            </div>

            <div class="table-wrapper modal-table-wrapper">
                <table class="table table-hover align-middle modal-table" id="tabelaJogosVenda">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nome</th>
                        <th>Categoria</th>
                        <th>Plataforma</th>
                        <th>Preço</th>
                        <th>Quantidade</th>
                        <th>Selecionar</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="j : ${jogos}">
                        <td th:text="${j.id}"></td>
                        <td th:text="${j.nome}"></td>
                        <td th:text="${j.categoria}"></td>
                        <td th:text="${j.plataforma}"></td>
                        <td th:text="${j.preco}"></td>
                        <td th:text="${j.quantidade}"></td>
                        <td>
                            <button type="button"
                                    class="btn btn-success btn-sm"
                                    onclick="selecionarJogoVenda(this)">
                                Selecionar
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <form th:action="@{/vendas/salvar}" method="post" class="mt-3">

                <div class="editar-grid">

                    <div class="campo">
                        <label>ID do jogo</label>
                        <input type="text" name="jogoId" id="cadIdJogo" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Nome do jogo</label>
                        <input type="text" name="nomeJogo" id="cadNomeJogo" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Categoria</label>
                        <input type="text" name="categoria" id="cadCategoria" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Quantidade</label>
                        <input type="number" name="quantidadeVendida" class="modal-input" required>
                    </div>

                    <div class="campo">
                        <label>Valor pago</label>
                        <input type="number" step="0.01" name="valorPago" class="modal-input" required>
                    </div>

                    <div class="campo">
                        <label>Nome do cliente</label>
                        <input type="text" name="nomeCliente" class="modal-input" required>
                    </div>

                    <div class="campo">
                        <label>Telefone do cliente</label>
                        <input type="text" name="telefoneCliente" class="modal-input">
                    </div>

                </div>

                <button type="submit" class="btn-salvar">Registrar</button>
            </form>

        </div>
    </div>
</div>

<div id="modalEditar" class="modal-overlay">
    <div class="modal-box modal-grande">

        <div class="modal-header">
            <h2>Editar Venda</h2>
            <button class="close-btn" onclick="fecharTodos()">&times;</button>
        </div>

        <div class="modal-body">

            <div class="search-box-wrapper mb-3">
                <i class="bi bi-search"></i>
                <input type="text"
                       class="form-control search-box"
                       placeholder="Pesquisar venda"
                       id="buscaEditarVenda">
            </div>

            <div class="table-wrapper modal-table-wrapper">
                <table class="table table-hover align-middle modal-table" id="tabelaEditarVendas">
                    <thead>
                    <tr>
                        <th>ID da Venda</th>
                        <th>ID do Jogo</th>
                        <th>Nome do Jogo</th>
                        <th>Categoria</th>
                        <th>Quantidade</th>
                        <th>Valor Pago</th>
                        <th>Nome do Cliente</th>
                        <th>Telefone</th>
                        <th>Selecionar</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="v : ${vendas}">
                        <td th:text="${v.id}"></td>
                        <td th:text="${v.jogo.id}"></td>
                        <td th:text="${v.jogo.nome}"></td>
                        <td th:text="${v.jogo.categoria}"></td>
                        <td th:text="${v.quantidadeVendida}"></td>
                        <td th:text="${v.valorPago}"></td>
                        <td th:text="${v.nomeCliente}"></td>
                        <td th:text="${v.telefoneCliente}"></td>
                        <td>
                            <button type="button"
                                    class="btn btn-primary btn-sm"
                                    onclick="selecionarVendaParaEditar(this)">
                                Selecionar
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <form th:action="@{/vendas/editar}" method="post" class="mt-3">

                <div class="editar-grid">

                    <div class="campo">
                        <label>ID da venda</label>
                        <input type="text" name="id" id="editarId" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>ID do jogo</label>
                        <input type="text" id="editarJogoId" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Nome do jogo</label>
                        <input type="text" id="editarNomeJogo" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Categoria</label>
                        <input type="text" id="editarCategoria" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Quantidade</label>
                        <input type="number" name="quantidadeVendida" id="editarQuantidade" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Valor pago</label>
                        <input type="number" step="0.01" name="valorPago" id="editarValor" class="modal-input">
                    </div>

                    <div class="campo">
                        <label>Nome do cliente</label>
                        <input type="text" name="nomeCliente" id="editarCliente" class="modal-input">
                    </div>

                    <div class="campo">
                        <label>Telefone do cliente</label>
                        <input type="text" name="telefoneCliente" id="editarTelefone" class="modal-input">
                    </div>

                </div>

                <button type="submit" class="btn-salvar">Atualizar</button>
            </form>

        </div>
    </div>
</div>

<div id="modalExcluir" class="modal-overlay">
    <div class="modal-box modal-grande">

        <div class="modal-header">
            <h2>Excluir Venda</h2>
            <button class="close-btn" onclick="fecharTodos()">&times;</button>
        </div>

        <div class="modal-body">

            <div class="search-box-wrapper mb-3">
                <i class="bi bi-search"></i>
                <input type="text"
                       class="form-control search-box"
                       placeholder="Pesquisar venda"
                       id="buscaExcluirVenda">
            </div>

            <div class="table-wrapper modal-table-wrapper">
                <table class="table table-hover align-middle modal-table" id="tabelaExcluirVendas">
                    <thead>
                    <tr>
                        <th>ID da Venda</th>
                        <th>ID do Jogo</th>
                        <th>Nome do Jogo</th>
                        <th>Categoria</th>
                        <th>Quantidade</th>
                        <th>Valor Pago</th>
                        <th>Nome do Cliente</th>
                        <th>Telefone</th>
                        <th>Selecionar</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="v : ${vendas}">
                        <td th:text="${v.id}"></td>
                        <td th:text="${v.jogo.id}"></td>
                        <td th:text="${v.jogo.nome}"></td>
                        <td th:text="${v.jogo.categoria}"></td>
                        <td th:text="${v.quantidadeVendida}"></td>
                        <td th:text="${v.valorPago}"></td>
                        <td th:text="${v.nomeCliente}"></td>
                        <td th:text="${v.telefoneCliente}"></td>
                        <td>
                            <button type="button"
                                    class="btn btn-danger btn-sm"
                                    onclick="selecionarVendaParaExcluir(this)">
                                Selecionar
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <form th:action="@{/vendas/excluir}" method="post" class="mt-3">

                <div class="editar-grid">

                    <div class="campo">
                        <label>ID da venda</label>
                        <input type="text" name="id" id="excluirId" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>ID do jogo</label>
                        <input type="text" id="excluirJogoId" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Nome do jogo</label>
                        <input type="text" id="excluirNomeJogo" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Categoria</label>
                        <input type="text" id="excluirCategoria" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Quantidade</label>
                        <input type="text" id="excluirQuantidade" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Valor pago</label>
                        <input type="text" id="excluirValor" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Nome do cliente</label>
                        <input type="text" id="excluirCliente" class="modal-input" readonly>
                    </div>

                    <div class="campo">
                        <label>Telefone do cliente</label>
                        <input type="text" id="excluirTelefone" class="modal-input" readonly>
                    </div>

                </div>

                <button type="submit" class="btn-salvar mt-3">
                    Excluir
                </button>
            </form>

        </div>
    </div>
</div>

<script src="vendas.js"></script>

</body>
</html>






